Roundtrip test failed

AST 1:

Module (SrcLoc "" -1 -1) (ModuleName "Main") [LanguagePragma (SrcLoc "" -1 -1) [Ident "PatternSynonyms",Ident "BangPatterns",Ident "PolyKinds",Ident "DataKinds",Ident "GADTs",Ident "FlexibleContexts",Ident "ViewPatterns"],LanguagePragma (SrcLoc "" -1 -1) [Ident "ExplicitForAll"]] Nothing (Just [EVar (UnQual (Ident "main"))]) [] [PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "Single")) [PVar (Ident "x")]) (PList [PVar (Ident "x")]) Unidirectional,TypeSig (SrcLoc "" -1 -1) [Ident "single"] (TyFun (TyList (TyVar (Ident "a"))) (TyApp (TyCon (UnQual (Ident "Maybe"))) (TyVar (Ident "a")))),FunBind [Match (SrcLoc "" -1 -1) (Ident "single") [PParen (PApp (UnQual (Ident "Single")) [PVar (Ident "x")])] Nothing (UnGuardedRhs (App (Con (UnQual (Ident "Just"))) (Var (UnQual (Ident "x"))))) Nothing,Match (SrcLoc "" -1 -1) (Ident "single") [PWildCard] Nothing (UnGuardedRhs (Con (UnQual (Ident "Nothing")))) Nothing],PatSynSig (SrcLoc "" -1 -1) (Ident "Single") Nothing [] [] (TyFun (TyVar (Ident "a")) (TyList (TyVar (Ident "a")))),PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "Single")) [PVar (Ident "x")]) (PList [PVar (Ident "x")]) ImplicitBidirectional,PatSynSig (SrcLoc "" -1 -1) (Ident "Single") Nothing [] [ParenA (ClassA (UnQual (Ident "Show")) [TyVar (Ident "a")])] (TyFun (TyVar (Ident "a")) (TyList (TyVar (Ident "a")))),PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "Single")) [PVar (Ident "x")]) (PList [PVar (Ident "x")]) ImplicitBidirectional,TypeSig (SrcLoc "" -1 -1) [Ident "f"] (TyForall Nothing [ParenA (ClassA (UnQual (Ident "Show")) [TyVar (Ident "a")])] (TyFun (TyList (TyVar (Ident "a"))) (TyVar (Ident "a")))),FunBind [Match (SrcLoc "" -1 -1) (Ident "f") [PParen (PApp (UnQual (Ident "Single")) [PVar (Ident "x")])] Nothing (UnGuardedRhs (Var (UnQual (Ident "x")))) Nothing],PatSynSig (SrcLoc "" -1 -1) (Ident "SinglePair") Nothing [] [] (TyFun (TyTuple Boxed [TyVar (Ident "a"),TyVar (Ident "a")]) (TyList (TyTuple Boxed [TyVar (Ident "a"),TyVar (Ident "a")]))),PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "SinglePair")) [PVar (Ident "x")]) (PList [PVar (Ident "x")]) ImplicitBidirectional,TypeSig (SrcLoc "" -1 -1) [Ident "f"] (TyForall Nothing [ParenA (ClassA (UnQual (Ident "Show")) [TyVar (Ident "a")])] (TyFun (TyList (TyTuple Boxed [TyVar (Ident "a"),TyVar (Ident "a")])) (TyCon (UnQual (Ident "String"))))),FunBind [Match (SrcLoc "" -1 -1) (Ident "f") [PParen (PApp (UnQual (Ident "SinglePair")) [PVar (Ident "x")])] Nothing (UnGuardedRhs (App (Var (UnQual (Ident "show"))) (Var (UnQual (Ident "x"))))) Nothing],PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "Q")) []) (PApp (UnQual (Ident "D")) []) ImplicitBidirectional,PatSynSig (SrcLoc "" -1 -1) (Ident "C") Nothing [] [] (TyFun (TyVar (Ident "a")) (TyApp (TyApp (TyCon (UnQual (Ident "X"))) (TyCon (UnQual (Ident "Maybe")))) (TyParen (TyApp (TyCon (UnQual (Ident "Maybe"))) (TyVar (Ident "a")))))),PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "C")) [PVar (Ident "x")]) (PApp (UnQual (Ident "Y")) [PParen (PApp (UnQual (Ident "Just")) [PVar (Ident "x")])]) ImplicitBidirectional,PatSynSig (SrcLoc "" -1 -1) (Ident "Syn") (Just [UnkindedVar (Ident "a"),UnkindedVar (Ident "b"),UnkindedVar (Ident "c")]) [] [] (TyCon (UnQual (Ident "Int"))),PatSynSig (SrcLoc "" -1 -1) (Ident "C") Nothing [] [ParenA (ClassA (UnQual (Ident "Show")) [TyTuple Boxed [TyVar (Ident "a"),TyCon (UnQual (Ident "Bool"))]])] (TyFun (TyVar (Ident "a")) (TyApp (TyApp (TyCon (UnQual (Ident "X"))) (TyCon (UnQual (Ident "Maybe")))) (TyParen (TyApp (TyCon (UnQual (Ident "Maybe"))) (TyTuple Boxed [TyVar (Ident "a"),TyCon (UnQual (Ident "Bool"))]))))),PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "C")) [PVar (Ident "x")]) (PApp (UnQual (Ident "Y")) [PParen (PApp (UnQual (Ident "Just")) [PTuple Boxed [PVar (Ident "x"),PApp (UnQual (Ident "True")) []]])]) ImplicitBidirectional,PatSynSig (SrcLoc "" -1 -1) (Ident "P") Nothing [] [] (TyApp (TyApp (TyCon (UnQual (Ident "T"))) (TyCon (UnQual (Ident "Bool")))) (TyVar (Ident "b"))),PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "P")) []) (PApp (UnQual (Ident "MkT")) [PApp (UnQual (Ident "True")) []]) Unidirectional,PatSynSig (SrcLoc "" -1 -1) (Ident "D") Nothing [] [] (TyFun (TyVar (Ident "a")) (TyApp (TyApp (TyCon (UnQual (Ident "T"))) (TyParen (TyApp (TyCon (UnQual (Ident "Maybe"))) (TyVar (Ident "a"))))) (TyCon (UnQual (Ident "Bool"))))),PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "D")) [PVar (Ident "x")]) (PApp (UnQual (Ident "MkT")) [PParen (PApp (UnQual (Ident "Just")) [PVar (Ident "x")])]) ImplicitBidirectional,PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "P")) [PVar (Ident "a"),PVar (Ident "b")]) (PApp (UnQual (Ident "Just")) [PTuple Boxed [PVar (Ident "a"),PVar (Ident "b")]]) ImplicitBidirectional,PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "Single")) [PVar (Ident "x")]) (PList [PVar (Ident "x")]) ImplicitBidirectional,PatSyn (SrcLoc "" -1 -1) (PInfixApp (PVar (Ident "a")) (UnQual (Symbol ":+:")) (PVar (Ident "b"))) (PTuple Boxed [PVar (Ident "a"),PVar (Ident "b")]) ImplicitBidirectional,PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "P")) [PVar (Ident "x")]) (PApp (UnQual (Ident "MkT")) [PLit Signless (Int 42),PVar (Ident "x")]) Unidirectional,PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "P")) [PVar (Ident "x"),PVar (Ident "y")]) (PApp (UnQual (Ident "MkT")) [PVar (Ident "x"),PVar (Ident "y")]) Unidirectional,PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "P")) [PVar (Ident "x")]) (PApp (UnQual (Ident "MkT")) [PParen (PViewPat (Var (UnQual (Ident "f"))) (PApp (UnQual (Ident "True")) [])),PVar (Ident "x")]) Unidirectional,GDataDecl (SrcLoc "" -1 -1) DataType [] (Ident "T") [] Nothing [GadtDecl (SrcLoc "" -1 -1) (Ident "MkT") [] (TyFun (TyVar (Ident "b")) (TyFun (TyParen (TyFun (TyVar (Ident "b")) (TyCon (UnQual (Ident "Bool"))))) (TyCon (UnQual (Ident "T")))))] [],PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "P")) [PVar (Ident "x"),PVar (Ident "f")]) (PApp (UnQual (Ident "MkT")) [PVar (Ident "x"),PVar (Ident "f")]) Unidirectional,PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "Single")) [PVar (Ident "x")]) (PList [PVar (Ident "x")]) Unidirectional,PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "P")) []) (PApp (UnQual (Ident "Just")) [PApp (UnQual (Ident "True")) []]) Unidirectional,PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "P")) []) (PLit Signless (Int 42)) ImplicitBidirectional,PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "P")) []) (PApp (Special UnitCon) []) ImplicitBidirectional,PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "Single")) [PVar (Ident "x")]) (PList [PVar (Ident "x")]) Unidirectional]

AST 2:

Module (SrcLoc "" -1 -1) (ModuleName "Main") [LanguagePragma (SrcLoc "" -1 -1) [Ident "PatternSynonyms",Ident "BangPatterns",Ident "PolyKinds",Ident "DataKinds",Ident "GADTs",Ident "FlexibleContexts",Ident "ViewPatterns"],LanguagePragma (SrcLoc "" -1 -1) [Ident "ExplicitForAll"]] Nothing (Just [EVar (UnQual (Ident "main"))]) [] [PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "Single")) [PVar (Ident "x")]) (PList [PVar (Ident "x")]) Unidirectional,TypeSig (SrcLoc "" -1 -1) [Ident "single"] (TyFun (TyList (TyVar (Ident "a"))) (TyApp (TyCon (UnQual (Ident "Maybe"))) (TyVar (Ident "a")))),FunBind [Match (SrcLoc "" -1 -1) (Ident "single") [PParen (PApp (UnQual (Ident "Single")) [PVar (Ident "x")])] Nothing (UnGuardedRhs (App (Con (UnQual (Ident "Just"))) (Var (UnQual (Ident "x"))))) Nothing,Match (SrcLoc "" -1 -1) (Ident "single") [PWildCard] Nothing (UnGuardedRhs (Con (UnQual (Ident "Nothing")))) Nothing],PatSynSig (SrcLoc "" -1 -1) (Ident "Single") Nothing [] [] (TyParen (TyFun (TyVar (Ident "a")) (TyList (TyVar (Ident "a"))))),PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "Single")) [PVar (Ident "x")]) (PList [PVar (Ident "x")]) ImplicitBidirectional,PatSynSig (SrcLoc "" -1 -1) (Ident "Single") Nothing [] [ParenA (ClassA (UnQual (Ident "Show")) [TyVar (Ident "a")])] (TyParen (TyFun (TyVar (Ident "a")) (TyList (TyVar (Ident "a"))))),PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "Single")) [PVar (Ident "x")]) (PList [PVar (Ident "x")]) ImplicitBidirectional,TypeSig (SrcLoc "" -1 -1) [Ident "f"] (TyForall Nothing [ParenA (ClassA (UnQual (Ident "Show")) [TyVar (Ident "a")])] (TyFun (TyList (TyVar (Ident "a"))) (TyVar (Ident "a")))),FunBind [Match (SrcLoc "" -1 -1) (Ident "f") [PParen (PApp (UnQual (Ident "Single")) [PVar (Ident "x")])] Nothing (UnGuardedRhs (Var (UnQual (Ident "x")))) Nothing],PatSynSig (SrcLoc "" -1 -1) (Ident "SinglePair") Nothing [] [] (TyParen (TyFun (TyTuple Boxed [TyVar (Ident "a"),TyVar (Ident "a")]) (TyList (TyTuple Boxed [TyVar (Ident "a"),TyVar (Ident "a")])))),PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "SinglePair")) [PVar (Ident "x")]) (PList [PVar (Ident "x")]) ImplicitBidirectional,TypeSig (SrcLoc "" -1 -1) [Ident "f"] (TyForall Nothing [ParenA (ClassA (UnQual (Ident "Show")) [TyVar (Ident "a")])] (TyFun (TyList (TyTuple Boxed [TyVar (Ident "a"),TyVar (Ident "a")])) (TyCon (UnQual (Ident "String"))))),FunBind [Match (SrcLoc "" -1 -1) (Ident "f") [PParen (PApp (UnQual (Ident "SinglePair")) [PVar (Ident "x")])] Nothing (UnGuardedRhs (App (Var (UnQual (Ident "show"))) (Var (UnQual (Ident "x"))))) Nothing],PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "Q")) []) (PApp (UnQual (Ident "D")) []) ImplicitBidirectional,PatSynSig (SrcLoc "" -1 -1) (Ident "C") Nothing [] [] (TyParen (TyFun (TyVar (Ident "a")) (TyApp (TyApp (TyCon (UnQual (Ident "X"))) (TyCon (UnQual (Ident "Maybe")))) (TyParen (TyApp (TyCon (UnQual (Ident "Maybe"))) (TyVar (Ident "a"))))))),PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "C")) [PVar (Ident "x")]) (PApp (UnQual (Ident "Y")) [PParen (PApp (UnQual (Ident "Just")) [PVar (Ident "x")])]) ImplicitBidirectional,PatSynSig (SrcLoc "" -1 -1) (Ident "Syn") (Just [UnkindedVar (Ident "a"),UnkindedVar (Ident "b"),UnkindedVar (Ident "c")]) [] [] (TyCon (UnQual (Ident "Int"))),PatSynSig (SrcLoc "" -1 -1) (Ident "C") Nothing [] [ParenA (ClassA (UnQual (Ident "Show")) [TyTuple Boxed [TyVar (Ident "a"),TyCon (UnQual (Ident "Bool"))]])] (TyParen (TyFun (TyVar (Ident "a")) (TyApp (TyApp (TyCon (UnQual (Ident "X"))) (TyCon (UnQual (Ident "Maybe")))) (TyParen (TyApp (TyCon (UnQual (Ident "Maybe"))) (TyTuple Boxed [TyVar (Ident "a"),TyCon (UnQual (Ident "Bool"))])))))),PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "C")) [PVar (Ident "x")]) (PApp (UnQual (Ident "Y")) [PParen (PApp (UnQual (Ident "Just")) [PTuple Boxed [PVar (Ident "x"),PApp (UnQual (Ident "True")) []]])]) ImplicitBidirectional,PatSynSig (SrcLoc "" -1 -1) (Ident "P") Nothing [] [] (TyParen (TyApp (TyApp (TyCon (UnQual (Ident "T"))) (TyCon (UnQual (Ident "Bool")))) (TyVar (Ident "b")))),PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "P")) []) (PApp (UnQual (Ident "MkT")) [PApp (UnQual (Ident "True")) []]) Unidirectional,PatSynSig (SrcLoc "" -1 -1) (Ident "D") Nothing [] [] (TyParen (TyFun (TyVar (Ident "a")) (TyApp (TyApp (TyCon (UnQual (Ident "T"))) (TyParen (TyApp (TyCon (UnQual (Ident "Maybe"))) (TyVar (Ident "a"))))) (TyCon (UnQual (Ident "Bool")))))),PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "D")) [PVar (Ident "x")]) (PApp (UnQual (Ident "MkT")) [PParen (PApp (UnQual (Ident "Just")) [PVar (Ident "x")])]) ImplicitBidirectional,PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "P")) [PVar (Ident "a"),PVar (Ident "b")]) (PApp (UnQual (Ident "Just")) [PTuple Boxed [PVar (Ident "a"),PVar (Ident "b")]]) ImplicitBidirectional,PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "Single")) [PVar (Ident "x")]) (PList [PVar (Ident "x")]) ImplicitBidirectional,PatSyn (SrcLoc "" -1 -1) (PInfixApp (PVar (Ident "a")) (UnQual (Symbol ":+:")) (PVar (Ident "b"))) (PTuple Boxed [PVar (Ident "a"),PVar (Ident "b")]) ImplicitBidirectional,PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "P")) [PVar (Ident "x")]) (PApp (UnQual (Ident "MkT")) [PLit Signless (Int 42),PVar (Ident "x")]) Unidirectional,PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "P")) [PVar (Ident "x"),PVar (Ident "y")]) (PApp (UnQual (Ident "MkT")) [PVar (Ident "x"),PVar (Ident "y")]) Unidirectional,PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "P")) [PVar (Ident "x")]) (PApp (UnQual (Ident "MkT")) [PParen (PViewPat (Var (UnQual (Ident "f"))) (PApp (UnQual (Ident "True")) [])),PVar (Ident "x")]) Unidirectional,GDataDecl (SrcLoc "" -1 -1) DataType [] (Ident "T") [] Nothing [GadtDecl (SrcLoc "" -1 -1) (Ident "MkT") [] (TyFun (TyVar (Ident "b")) (TyFun (TyParen (TyFun (TyVar (Ident "b")) (TyCon (UnQual (Ident "Bool"))))) (TyCon (UnQual (Ident "T")))))] [],PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "P")) [PVar (Ident "x"),PVar (Ident "f")]) (PApp (UnQual (Ident "MkT")) [PVar (Ident "x"),PVar (Ident "f")]) Unidirectional,PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "Single")) [PVar (Ident "x")]) (PList [PVar (Ident "x")]) Unidirectional,PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "P")) []) (PApp (UnQual (Ident "Just")) [PApp (UnQual (Ident "True")) []]) Unidirectional,PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "P")) []) (PLit Signless (Int 42)) ImplicitBidirectional,PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "P")) []) (PApp (Special UnitCon) []) ImplicitBidirectional,PatSyn (SrcLoc "" -1 -1) (PApp (UnQual (Ident "Single")) [PVar (Ident "x")]) (PList [PVar (Ident "x")]) Unidirectional]

